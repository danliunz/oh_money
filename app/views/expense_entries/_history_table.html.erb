<table class="table table-hover expense_history_table">
  <tbody>
    <% expense_entries_by_date = group_expense_entries_by_purchase_date(expense_history.entries) %>
    <% expense_entries_by_date.each do |expense_entries_of_one_day| %>
      <tr>
        <td colspan="3" class="active date-header">
          <%= expense_entries_of_one_day[:date].strftime('%Y-%m-%d') +
            " | total cost: " +
            cost_to_display(expense_entries_of_one_day[:total_cost]) %>
        </td>
      </tr>

      <% expense_entries_of_one_day[:entries].each do |expense_entry| %>
        <tr class="expense_entry_row">
          <th>
            <div class="dropdown">
              <button id="expense_entry_<%= expense_entry.id %>_dropdown_trigger"
                type="button" class="btn btn-default dropdown-toggle"
                data-toggle="dropdown">
                <span class="glyphicon glyphicon-align-justify"></span>
              </button>
              <ul class="dropdown-menu">
                <li>
                  <a href="<%= show_expense_entry_path(expense_entry) %>"
                    title="edit the entry">
                    <span class="glyphicon glyphicon-edit"></span>
                    <span>edit</span>
                  </a>
                </li>
                <li>
                  <a href="<%= delete_expense_entry_path(expense_entry) %>"
                    data-method="post" data-confirm="Delete the expense entry permanently?"
                    title="delete the entry">
                    <span class="glyphicon glyphicon-remove-circle"></span>
                    <span>delete</span>
                  </a>
                </li>
              </ul>
            </div>

            <%= link_to expense_entry.item_type.name,
              show_item_type_path(expense_entry.item_type),
              class: "btn btn-default" %>
          </th>

          <td><%= cost_to_display(expense_entry.cost) %></td>

          <td>
            <% expense_entry.tags.each do |tag| %>
              <span class="label label-default"><%= tag.name %></span>
            <% end %>
          </td>
        </tr>
      <% end %>
    <% end %>
  </tbody>
</table>

<div>
  <%= will_paginate expense_history.entries, renderer: BootstrapPagination::Rails %>
</div>
